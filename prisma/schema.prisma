generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  role      String   @default("user")

  @@map("users")
}

model Dancer {
  id          Int                 @id @default(autoincrement())
  userId      Int
  email       String
  firstName   String
  lastName    String
  birthDate   DateTime
  postalCode  String
  city        String
  address     String
  phone       String
  schoolLevel dancers_schoolLevel
  tShirtSize  dancers_tShirtSize
  otherInfo   String?
  createdAt   DateTime            @default(now())
  updatedAt   DateTime            @updatedAt

  @@index([userId], map: "dancers_userId_fkey")
  @@map("dancers")
}

model EmergencyContact {
  id        Int                     @id @default(autoincrement())
  dancerId  Int
  type      emergency_contacts_type
  firstName String
  lastName  String
  phone     String
  createdAt DateTime                @default(now())
  updatedAt DateTime                @updatedAt

  @@index([dancerId], map: "emergency_contacts_dancerId_fkey")
  @@map("emergency_contacts")
}

model DanceGroup {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  description String
  schedule    String
  ageGroup    String
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("dance_groups")
}

model Registration {
  id           Int                  @id @default(autoincrement())
  dancerId     Int
  danceGroupId Int
  sportCode    String?
  status       registrations_status @default(DRAFT)
  submittedAt  DateTime?
  reviewedAt   DateTime?
  reviewedBy   Int?
  notes        String?
  createdAt    DateTime             @default(now())
  updatedAt    DateTime             @updatedAt

  @@unique([dancerId, danceGroupId])
  @@index([danceGroupId], map: "registrations_danceGroupId_fkey")
  @@index([reviewedBy], map: "registrations_reviewedBy_fkey")
  @@map("registrations")
}

model guardians {
  id         Int      @id @default(autoincrement())
  dancerId   Int      @unique
  email      String
  firstName  String
  lastName   String
  address    String
  postalCode String
  city       String
  phone      String
  authorized Boolean  @default(false)
  createdAt  DateTime @default(now())
  updatedAt  DateTime
}

enum emergency_contacts_type {
  EMERGENCY_AND_PICKUP
  EMERGENCY_ONLY
  PICKUP_ONLY
}

enum registrations_status {
  DRAFT
  SUBMITTED
  APPROVED
  REJECTED
}

enum dancers_schoolLevel {
  CP
  CE1
  CE2
  CM1
  CM2
  SIXIEME
  CINQUIEME
  QUATRIEME
  TROISIEME
  SECONDE
  PREMIERE
  TERMINALE
  POST_BAC
  ADULTE
}

enum dancers_tShirtSize {
  XS
  S
  M
  L
  XL
  XXL
}
